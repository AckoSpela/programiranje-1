\documentclass[arhiv]{../izpit}
\usepackage{fouriernc}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{fancyvrb}
\VerbatimFootnotes{}

\begin{document}

\izpit{Programiranje I: 3.\ izpit}{22.\ november 2018}{
  Čas reševanja je 60 minut.
  Veliko uspeha!
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\naloga

Write a \emph{tail recursive} function that takes a list of integers and
computes its sum. For example for the list \verb|[0; 1; 2; 3; 4]|, it computes
\verb|10|, for the list enumerating the natural numbers up to a million, obtained as \verb|List.init 1000001 (fun x -> x)| you should obtain \verb|500000500000|.

\naloga

A list is sorted if its head is smaller than the next element, and furthermore the list without the head is also sorted. Write a function that checks that a list of integers is sorted in increasing order. For example \verb|[0; 1; 1; 42]| and \verb|[-1]| are sorted, \verb|[2; -2]| is not.

\naloga

Write a function that injects an integer \verb|x| into a sorted list of integers. For example, injecting \verb|4| into \verb|[0; 1; 1; 42]| yields  \verb|[0; 1; 1; 4; 42]|.

Notice that injecting all the elements of a given list \verb|xs| into an empty list will create a sorted version of \verb|xs|.

Use this observation to create a sorting function that takes a list of integers and returns a sorted list containing the same elements.

\naloga

The sorting algorithm we defined does not actually depend on the fact that the input is a list of integers.

Create a new sorting function that, in addition to the list to sort, takes a function \verb|cmp| as a further argument. This \verb|cmp| function shall be used to determine if one element of a list is smaller than another.

For example, we can use \verb|fun j k -> not (j < k)| to invert the usual order on integers. Using this as \verb|cmp| argument, \verb|[0; 1; 1; 42]| gets sorted into \verb|[42; 1; 1; 0]|.

\naloga

We want to model the boarding process of an air plane. A person taking the plane is represented as an element of the record type
%
\begin{verbatim}
type flyer = { status : status ; name : string }
\end{verbatim}
%
where status can be either staff or passenger. If the status is passenger, it further carries a priority. A priority can be either top-priority or a priority group represented by an integer.

A list of flyers could look like this:
\begin{verbatim}
let flyers = [ {status = Staff; name = "Quinn"}
             ; {status = Passenger (Group 0); name = "Xiao"}
             ; {status = Passenger Top; name = "Jaina"}
             ; {status = Passenger (Group 1000); name = "Aleks"}
             ; {status = Passenger (Group 1000); name = "Robin"}
             ; {status = Staff; name = "Alan"}
             ]
\end{verbatim}

Define a type \verb|priority| to represent the possible priorities, and a type \verb|status|.

\naloga

Write a function that sorts a list of flyers into a boarding sequence such that first the staff boards, then the top priority flyers, then groups ordered by decreasing integers. For example, a valid boarding sequence for the above flyers would be given by

\begin{verbatim}
[{status = Staff; name = "Quinn"};
 {status = Staff; name = "Alan"};
 {status = Passenger Top; name = "Jaina"};
 {status = Passenger (Group 1000); name = "Robin"};
 {status = Passenger (Group 1000); name = "Aleks"};
 {status = Passenger (Group 0); name = "Xiao"}]
\end{verbatim}

\naloga

Write a function that takes a list of flyers and cuts it into blocks, ordered as specified by the boarding sequence, such that within each block all flyers have the same status and priority.

For the above example, you might obtain four blocks as in
\begin{verbatim}
[[{status = Staff; name = "Alan"}; {status = Staff; name = "Quinn"}];
 [{status = Passenger Top; name = "Jaina"}];
 [{status = Passenger (Group 1000); name = "Aleks"};
  {status = Passenger (Group 1000); name = "Robin"}];
 [{status = Passenger (Group 0); name = "Xiao"}]]
\end{verbatim}

\end{document}
